---
title: "RNAseq Data Processing & Analysing Course"
author: "Alex Gibbs"
#full-width: true
---

# Day 4 - Observing the outputs of the nf-core/differentialabundance pipeline and further analyses

---

## Recap from Day 3
---
---

- Yesterday we covered:
  - How to check the quality of the rnaseq data that we processed.
  - How to find the relevant outputs.
  - How exececute the differentialabundance pipeline.

---

<br>

---

## Outputs from the differentialabundance pipeline
---
---

- We should all have had an email from *SCW HAWK - HPC SERVICES* notifying you of a successful pipeline run.
- Sometimes the email function doesn't work. We can just log in and check ourselves.
- To check, we need to log back onto HAWK, load the tmux module, and then open the session that we created.
- NOTE: When using tmux, we need to make sure we are logged into the correct node. When we covered the log ins yesterday, we logged onto the cl1 node. The tmux session we made will only be present on the cl1 node. If we were to log in to the cl2 node, we wouldnt be able to find the tmux session.

<br>

```
#log onto HAWK
c.c1234567@hawklogin01.cf.ac.uk
PASSWORD

#move to the working directory (scratch)
cd /scratch/c.c1234567/rnaseq

#load tmux
module load tmux

#open our tmux session
tmux attach -t diff-abundance
```

<br>

- Upon opening the session, we should have a window that looks like this:

<img src="/assets/img/figure-19.png" alt="tmux completed run" width="1000"/>

- In this situation, the process took around 8 minutes. As all of us were using the pipeline at the same time, these times will likely vary. Download times will also depend on the size and number of files being downloaded.

**Report directory**
- This is where the main reporting output of the workflow is stored.
- Here we can find the report webpage (.html) and a zip file containing an R markdown file with all of the parameters to customise the reporting.

**Plots directory**
- Here we can find all of the stand-alone plots generated by the pipeline.
- Most of these plots are included in the webpage report.
- Plots include: 
    - QC: quality control plots from initial processing.
    - Exploratory: boxplots, PCA plots, correlation and dendograms. These are all plots that can be used to abundance distributions, sample clustering/correlations and observe any outliers.
    - Differential: volcano plots showing DEGs.

**Tables directory**
- This is where we can find the tables containing the count data:
    - Annotation: annotation matrix.
    - Processed Abundance: processed abundance values from initial processing. i.e. normalised counts from DESeq2.
    - Differential: Results of diferential analysis. filtered and unfiltered tables for expression.

**Pipeline Information directory**
- This directory contains all the files relevant to the pipeline that was run, such as a nextflow report, pipeline report.
- These files can be used to make a report if needed (handy when writing methods section).
- We donâ€™t need any of these files for the next stages.

**ShinyNGS App directory**
- This is where you will find the relevant files to run the Shiny app in R.
- We will cover how to run this below.

---
# So we've processed the samples and run the analysis pipeline... Now what?

- Now we can start exploring the data and begin answering our hypotheses.
- There are multiple things that we can do and multiple places we can start.
- I would highly reccommend that we start with the webpage report to have a general overview of the outputs.
- From there, we can then look at the Shiny app and use the built-in tools and filters to start exploring the data.
- We can then run additional analyses, such as Gene Set Enrichment Analysis (GSEA), Ingenuity Pathway Analysis (IPA), and further enrichment analysis tool on various web-tools.

## Webpage Report
- Lets start with the webpage report. We will firstly need to transfer the directory to our computers.
- We can do this with our file transfer apps, MobaXterm and FileZilla, or we could use code to transfer.
- Click this [link](INSERT LINK HERE!!!!!!*********) to see how to transfer using MobaXterm or FileZilla.
- See the code below for how to transfer using code:

```
Open a new shell window and cd to the directory where you want the directory to be transferred to.

#Move to downloads directory
cd /Users/Alex/Downloads

#transfer directory from HAWK to downloads
scp -r c.c1234567@hawklogin.cf.ac.uk:/scratch/c.c1234567/rnaseq/outputs/report .

#You will be asked to input your HAWK password and hit enter.
#Then the transfer will start.
```

- Now that we have the directory transferred, we can go ahead and navigate to it and open the report web page (study.html)
